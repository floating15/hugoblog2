<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Summary of Data Cleaning Skills | haoming&#39;s blog</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    
  </head>

  <body>
    <nav>
    <ul class="menu">
      
      <li><a href="/">Home</a></li>
      
      <li><a href="/note/">Notes</a></li>
      
      <li><a href="/tags/">Tags</a></li>
      
      <li><a href="/post/">Posts</a></li>
      
      <li><a href="/replicate/">Replicate</a></li>
      
    </ul>
    <hr/>
    </nav>




<div class="article-meta">
<h1><span class="title">Summary of Data Cleaning Skills</span></h1>  

<h2 class="date">2019/07/08</h2>
</div>


<main>



<h1 id="summary">Summary</h1>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">df<span style="color:#666">.</span>head(n)
df<span style="color:#666">.</span>sample(n)
df<span style="color:#666">.</span>info()
df<span style="color:#666">.</span>describe()
df<span style="color:#666">.</span>shape
df<span style="color:#666">.</span>values
df<span style="color:#666">.</span>columns
df<span style="color:#666">.</span>index
</code></pre></div><h1 id="sort">Sort</h1>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">df<span style="color:#666">.</span>sort_values(
    by<span style="color:#666">=</span><span style="color:#ba2121">&#34;col_name&#34;</span>,
    axis<span style="color:#666">=</span><span style="color:#666">0</span>,
    ascending<span style="color:#666">=</span><span style="color:#008000;font-weight:bold">True</span>,
    inplace<span style="color:#666">=</span><span style="color:#008000;font-weight:bold">False</span>
)
</code></pre></div><div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">df<span style="color:#666">.</span>sort_index(
    level<span style="color:#666">=</span>[<span style="color:#ba2121">&#34;outter_index&#34;</span>, <span style="color:#ba2121">&#34;inner_index&#34;</span>],
    ascending<span style="color:#666">=</span><span style="color:#008000;font-weight:bold">False</span>
)
</code></pre></div><h1 id="set-index">Set index</h1>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">df<span style="color:#666">.</span>set_index(<span style="color:#ba2121">&#34;col&#34;</span>)
df<span style="color:#666">.</span>ser_index(<span style="color:#ba2121">&#34;outter_index&#34;</span>, <span style="color:#ba2121">&#34;inner_index&#34;</span>)

df<span style="color:#666">.</span>reset_index()
df<span style="color:#666">.</span>reset_index(drop<span style="color:#666">=</span><span style="color:#008000;font-weight:bold">False</span>)
</code></pre></div><h1 id="subset-and-slice">Subset and Slice</h1>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#408080;font-style:italic"># subset by row</span>
df[df[<span style="color:#ba2121">&#34;col&#34;</span>] <span style="color:#666">&gt;</span> <span style="color:#666">0</span>]

df[
    (df<span style="color:#666">.</span>col1 <span style="color:#666">&gt;</span> <span style="color:#666">0</span>) <span style="color:#666">&amp;</span>
    (df<span style="color:#666">.</span>col2 <span style="color:#666">&gt;</span><span style="color:#666">0</span>)
]

df[
    df<span style="color:#666">.</span>col<span style="color:#666">.</span>isin([<span style="color:#ba2121">&#34;xxx&#34;</span>, <span style="color:#ba2121">&#34;yyy&#34;</span>])
]


<span style="color:#408080;font-style:italic"># with loc method</span>
df<span style="color:#666">.</span>loc[
    [<span style="color:#ba2121">&#34;outer_index1&#34;</span>, <span style="color:#ba2121">&#34;outer_index_2&#34;</span>]
]

df<span style="color:#666">.</span>loc[
    [
        (<span style="color:#ba2121">&#34;outer_index_1&#34;</span>, <span style="color:#ba2121">&#34;inner_index_1&#34;</span>),
        (<span style="color:#ba2121">&#34;outer_index_2&#34;</span>, <span style="color:#ba2121">&#34;inner_index_2&#34;</span>),
        (<span style="color:#ba2121">&#34;outer_index_3&#34;</span>, <span style="color:#ba2121">&#34;inner_index_3&#34;</span>),
    ]
]

df<span style="color:#666">.</span>loc[
    <span style="color:#ba2121">&#34;outer_index_i&#34;</span> : <span style="color:#ba2121">&#34;outer_index_j&#34;</span>
]

df<span style="color:#666">.</span>loc[
    (<span style="color:#ba2121">&#34;outer_index_i&#34;</span>, <span style="color:#ba2121">&#34;inner_index_i&#34;</span>):
    (<span style="color:#ba2121">&#34;outer_index_j&#34;</span>, <span style="color:#ba2121">&#34;inner_index_j&#34;</span>)
]
</code></pre></div><div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#408080;font-style:italic"># subset &amp; Slice by col</span>
df[<span style="color:#ba2121">&#34;col&#34;</span>]
df<span style="color:#666">.</span>col
df[df<span style="color:#666">.</span>col <span style="color:#666">==</span> df<span style="color:#666">.</span>col<span style="color:#666">.</span>max()]<span style="color:#666">.</span>col  <span style="color:#408080;font-style:italic"># equal to df.col.max()</span>
df[
    [<span style="color:#ba2121">&#34;col1&#34;</span>, <span style="color:#ba2121">&#34;col2&#34;</span>]
]

<span style="color:#408080;font-style:italic"># with loc method</span>
df_sort_id<span style="color:#666">.</span>loc[
    [
        (<span style="color:#ba2121">&#34;outer_index_1&#34;</span>, <span style="color:#ba2121">&#34;inner_index_1&#34;</span>),
        (<span style="color:#ba2121">&#34;outer_index_2&#34;</span>, <span style="color:#ba2121">&#34;inner_index_2&#34;</span>),
        (<span style="color:#ba2121">&#34;outer_index_3&#34;</span>, <span style="color:#ba2121">&#34;inner_index_3&#34;</span>),
    ] ,
    [<span style="color:#ba2121">&#34;col1&#34;</span>,  <span style="color:#ba2121">&#34;col2&#34;</span>]
]

df_sort_id<span style="color:#666">.</span>loc[
    (<span style="color:#ba2121">&#34;Julia&#34;</span>, <span style="color:#ba2121">&#34;1&#34;</span>): (<span style="color:#ba2121">&#34;Julia&#34;</span>, <span style="color:#ba2121">&#34;3&#34;</span>) ,
    <span style="color:#ba2121">&#34;col_i&#34;</span>: <span style="color:#ba2121">&#34;col_j&#34;</span>
]
</code></pre></div><h1 id="aggregate">Aggregate</h1>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">df<span style="color:#666">.</span>col<span style="color:#666">.</span>mean()
df[[<span style="color:#ba2121">&#34;col1&#34;</span>, <span style="color:#ba2121">&#34;col2&#34;</span>]]<span style="color:#666">.</span>mean()

<span style="color:#008000;font-weight:bold">def</span> <span style="color:#00f">pct30</span>(col):
    <span style="color:#008000;font-weight:bold">return</span> col<span style="color:#666">.</span>quantile(<span style="color:#666">0.3</span>)

df<span style="color:#666">.</span>col<span style="color:#666">.</span>agg(<span style="color:#008000">min</span>)
df[<span style="color:#ba2121">&#34;col1&#34;</span>, <span style="color:#ba2121">&#34;col2&#34;</span>]<span style="color:#666">.</span>agg([<span style="color:#008000">min</span>, <span style="color:#008000">max</span>, np<span style="color:#666">.</span>mean, np<span style="color:#666">.</span>median, pct30])
df[<span style="color:#ba2121">&#34;col1&#34;</span>, <span style="color:#ba2121">&#34;col2&#34;</span>]<span style="color:#666">.</span>agg([cumsum, cummin, cumprod])
</code></pre></div><div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">df<span style="color:#666">.</span>mean(axis<span style="color:#666">=</span><span style="color:#ba2121">&#34;columns&#34;</span>) <span style="color:#408080;font-style:italic"># calculate for every rows</span>
df<span style="color:#666">.</span>mean(axis<span style="color:#666">=</span><span style="color:#ba2121">&#34;index&#34;</span>) <span style="color:#408080;font-style:italic"># calculate for every columns</span>
</code></pre></div><h1 id="duplicate-value">Duplicate Value</h1>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">df<span style="color:#666">.</span>drop_duplicates(
    subset<span style="color:#666">=</span><span style="color:#ba2121">&#34;col&#34;</span>
)

df<span style="color:#666">.</span>drop_duplicates(
    subset<span style="color:#666">=</span>[<span style="color:#ba2121">&#34;col1&#34;</span>, <span style="color:#ba2121">&#34;col2&#34;</span>]
)
</code></pre></div><h1 id="counting">Counting</h1>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">df<span style="color:#666">.</span>col<span style="color:#666">.</span>value_counts(
    sort<span style="color:#666">=</span><span style="color:#008000;font-weight:bold">True</span>,
    normalize<span style="color:#666">=</span><span style="color:#008000;font-weight:bold">False</span>
)
</code></pre></div><div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#408080;font-style:italic"># count missing value</span>
df<span style="color:#666">.</span>isna()
df<span style="color:#666">.</span>isna()<span style="color:#666">.</span>any()
df<span style="color:#666">.</span>isna()<span style="color:#666">.</span>sum()
df<span style="color:#666">.</span>isna()<span style="color:#666">.</span>sum()<span style="color:#666">.</span>plot(kind<span style="color:#666">=</span><span style="color:#ba2121">&#34;bar&#34;</span>)
</code></pre></div><h1 id="groupby">Groupby</h1>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#408080;font-style:italic"># groupby method</span>
df<span style="color:#666">.</span>groupby(
    <span style="color:#ba2121">&#34;col&#34;</span>
)
df<span style="color:#666">.</span>groupby(
    [<span style="color:#ba2121">&#34;col1&#34;</span>, <span style="color:#ba2121">&#34;col2&#34;</span>]
)
</code></pre></div><div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#408080;font-style:italic"># pivot table</span>
df<span style="color:#666">.</span>pivot_table(
    values<span style="color:#666">=</span>[<span style="color:#ba2121">&#34;col1&#34;</span>, <span style="color:#ba2121">&#34;col2&#34;</span>], 
    index<span style="color:#666">=</span>[<span style="color:#ba2121">&#34;col3&#34;</span>, <span style="color:#ba2121">&#34;col4&#34;</span>], 
    columns<span style="color:#666">=</span>[<span style="color:#ba2121">&#34;col5&#34;</span>, <span style="color:#ba2121">&#34;col6&#34;</span>],
    aggfunc<span style="color:#666">=</span><span style="color:#ba2121">&#39;mean&#39;</span>, 
    fill_value<span style="color:#666">=</span><span style="color:#008000;font-weight:bold">None</span>, 
    margins<span style="color:#666">=</span><span style="color:#008000;font-weight:bold">False</span>, 
    dropna<span style="color:#666">=</span><span style="color:#008000;font-weight:bold">True</span>, 
    margins_name<span style="color:#666">=</span><span style="color:#ba2121">&#39;All&#39;</span>
)
</code></pre></div><h1 id="merge-join-and-concat">Merge, Join and Concat</h1>

</main>

  <footer>
  <script defer src="//yihui.org/js/math-code.js"></script>
<script defer src="//mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>

<script defer src="//yihui.org/js/center-img.js"></script>

  
  <hr/>
  © <a href="https://yihui.org">Yihui Xie</a> 2017 &ndash; 2022 | <a href="https://www.baidu.com">Github</a> | <a href="https://www.zhihu.com">Twitter</a>
  
  </footer>
  </body>
</html>






